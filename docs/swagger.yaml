openapi: 3.0.0
info:
  description: "API documentation for the Team Beetle Stage 3 Task on the Backend Track"
  version: "1.0.0"
  title: "Team Beetle Boilerplate API documentation"
  license:
    name: "MIT"
    url: "https://raw.githubusercontent.com/daviduzondu/team_beetle_hng_boilerplate_node_web/main/LICENSE"

tags:
  - name: Authentication
    description: Endpoints for user authentication and authorization

  - name: Users
    description: User management operations

  - name: Organization
    description: Organization management operations

  - name: Payments
    description: Payment processing and management

  - name: Messages
    description: Messaging functionality, including emails

  - name: Settings
    description: User and application settings management

  - name: Contact
    description: Contact form submissions

  - name: Waitlist
    description: Waitlist management for upcoming features

  - name: Widgets
    description: Widget management for user dashboards

  - name: Data
    description: General data operations and queries

  - name: Charts
    description: Chart data generation and management

  - name: Content
    description: Content management for static pages

  - name: Notifications
    description: User notification management

  - name: Blog
    description: Blog post management

  - name: Invite
    description: User invitation system

  - name: AI
    description: AI-related operations and integrations

  - name: Activity
    description: User activity logging and retrieval

    
paths:
  /auth:
    post:
      tags:
        - Authentication
      summary: Authenticate user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthRequest'
      responses:
        '200':
          description: Successful authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'

  /auth/social:
    post:
      tags:
        - Authentication
      summary: Social authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SocialAuthRequest'
      responses:
        '200':
          description: Successful social authentication
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthResponse'

  /auth/magic-link:
    post:
      tags:
        - Authentication    
      summary: Request magic link
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MagicLinkRequest'
      responses:
        '200':
          description: Magic link sent successfully

  /auth/change-password:
    put:
      tags:
        - Authentication    
      summary: Change user password
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangePasswordRequest'
      responses:
        '200':
          description: Password changed successfully

  /users:
    get:
      tags:
        - Users
      summary: Get all users
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
        - in: query
          name: limit
          schema:
            type: integer
      responses:
        '200':
          description: List of users
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UsersList'

    post:
      tags:
        - Users
      summary: Create a new user
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserRequest'
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'

  /users/{userId}:
    get:
      tags:
        - Users
      summary: Get user by ID
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: User details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'

    put:
      tags:
        - Users
      summary: Update user
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateUserRequest'
      responses:
        '200':
          description: User updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/User'

    delete:
      tags:
        - Users
      summary: Delete user
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
      responses:
        '204':
          description: User deleted successfully

  /users/{userId}/export:
    get:
      tags:
        - Users
      summary: Export user data
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: userId
          required: true
          schema:
            type: string
          description: ID of the user whose data is to be exported
      responses:
        '200':
          description: User data exported successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserDataExport'
        '404':
          description: User not found
        '500':
          description: Internal server error

  /organizations:
    get:
      tags:
        - Organization
      summary: Get all organizations
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
        - in: query
          name: limit
          schema:
            type: integer
      responses:
        '200':
          description: List of organizations
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OrganizationsList'

    post:
      tags:
        - Organization
      summary: Create a new organization
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateOrganizationRequest'
      responses:
        '201':
          description: Organization created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'

  /organizations/{orgId}:
    get:
      tags:
        - Organization
      summary: Get organization by ID
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: orgId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Organization details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'

    put:
      tags:
        - Organization
      summary: Update organization
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: orgId
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateOrganizationRequest'
      responses:
        '200':
          description: Organization updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'

    delete:
      tags:
        - Organization
      summary: Delete organization
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: orgId
          required: true
          schema:
            type: string
      responses:
        '204':
          description: Organization deleted successfully

  /payments:
    post:
      tags:
        - Payments
      summary: Create a payment
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreatePaymentRequest'
      responses:
        '201':
          description: Payment created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'
    
    get:
      tags:
        - Payments
      summary: List payments
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
          description: Page number for pagination
        - in: query
          name: limit
          schema:
            type: integer
          description: Number of results per page
      responses:
        '200':
          description: List of payments
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Payment'
  
  /payments/{paymentId}:
    get:
      tags:
        - Payments
      summary: Get payment by ID
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: paymentId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Payment details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Payment'

  /messages:
    post:
      tags:
        - Messages
      summary: Send a message
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SendMessageRequest'
      responses:
        '201':
          description: Message sent successfully

  /settings:
    get:
      tags:
        - Settings
      summary: Get user settings
      security:
        - BearerAuth: []
      responses:
        '200':
          description: User settings
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSettings'

    put:
      tags:
        - Settings      
      summary: Update user settings
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateSettingsRequest'
      responses:
        '200':
          description: Settings updated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserSettings'

  /contact:
    post:
      tags:
        - Contact    
      summary: Submit contact form
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContactFormRequest'
      responses:
        '201':
          description: Contact form submitted successfully

  /waitlist:
    post:
      tags:
        - Waitlist
      summary: Join waitlist
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WaitlistRequest'
      responses:
        '201':
          description: Added to waitlist successfully

  /widgets:
    get:
      tags:
        - Widgets
      summary: Get user widgets
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
        - in: query
          name: limit
          schema:
            type: integer
      responses:
        '200':
          description: List of user widgets
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WidgetsList'

    post:
      tags:
        - Widgets
      summary: Create a new widget
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateWidgetRequest'
      responses:
        '201':
          description: Widget created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Widget'

  /widgets/{widgetId}:
    get:
      tags:
        - Widgets
      summary: Get widget by ID
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: widgetId
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Widget details
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Widget'

  /data:
    get:
      tags:
        - Data
      summary: Get data list
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
        - in: query
          name: limit
          schema:
            type: integer
        - in: query
          name: search
          schema:
            type: string
        - in: query
          name: sort
          schema:
            type: string
      responses:
        '200':
          description: List of data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataList'

  /charts:
    get:
      tags:
        - Charts
      summary: Get chart data
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: type
          schema:
            type: string
        - in: query
          name: startDate
          schema:
            type: string
            format: date
        - in: query
          name: endDate
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Chart data
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChartData'

  /content:
    put:
      tags:
        - Content
      summary: Update content
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateContentRequest'
      responses:
        '200':
          description: Content updated successfully

  /notifications:
    get:
      tags:
        - Notifications
      summary: Get user notifications
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
        - in: query
          name: limit
          schema:
            type: integer
      responses:
        '200':
          description: List of notifications
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotificationsList'
  
  /notifications/{notificationId}/read:
    put:
      tags:
        - Notifications
      summary: Mark a notification as read
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: notificationId
          required: true
          schema:
            type: string
          description: ID of the notification to mark as read
      responses:
        '200':
          description: Notification marked as read successfully
        '404':
          description: Notification not found
        '500':
          description: Internal server error

  /blog:
    get:
      tags:
        - Blog
      summary: Get blog posts
      parameters:
        - in: query
          name: page
          schema:
            type: integer
        - in: query
          name: limit
          schema:
            type: integer
      responses:
        '200':
          description: List of blog posts
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlogPostsList'
    post:
      tags:
        - Blog
      summary: Create a new blog post
      parameters:
        - in: body
          name: body
          description: Blog post content
          required: true
          schema:
            $ref: '#/components/schemas/BlogPost'
      responses:
        '201':
          description: Blog post created successfully
        '400':
          description: Bad request, invalid input
        '500':
          description: Internal server error

  /blog/{id}:
    get:
      tags:
        - Blog
      summary: Get a blog post by ID
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: ID of the blog post to retrieve
      responses:
        '200':
          description: Blog post retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlogPost'
        '404':
          description: Blog post not found
        '500':
          description: Internal server error

    put:
      tags:
        - Blog
      summary: Update a blog post
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: ID of the blog post to update
        - in: body
          name: body
          description: Updated blog post content
          required: true
          schema:
            $ref: '#/components/schemas/BlogPost'
      responses:
        '200':
          description: Blog post updated successfully
        '400':
          description: Bad request, invalid input
        '404':
          description: Blog post not found
        '500':
          description: Internal server error

    delete:
      tags:
        - Blog
      summary: Delete a blog post
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
          description: ID of the blog post to delete
      responses:
        '204':
          description: Blog post deleted successfully
        '404':
          description: Blog post not found
        '500':
          description: Internal server error

  /invites:
    post:
      tags:
        - Invite
      summary: Create invite link
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateInviteRequest'
      responses:
        '201':
          description: Invite link created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InviteLink'

  /email-templates:
    get:
      tags:
        - Email
      summary: Get email templates
      security:
        - BearerAuth: []
      responses:
        '200':
          description: List of email templates
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailTemplatesList'

    post:
      tags:
        - Email
      summary: Create email template
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateEmailTemplateRequest'
      responses:
        '201':
          description: Email template created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/EmailTemplate'

  /ai:
    post:
      tags:
        - AI
      summary: Make AI request
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AIRequest'
      responses:
        '200':
          description: AI response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AIResponse'

  /activity-log:
    get:
      tags:
        - Activity
      summary: Get activity log
      security:
        - BearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
        - in: query
          name: limit
          schema:
            type: integer
      responses:
        '200':
          description: Activity log
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ActivityLog'

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer

  schemas:
    AuthRequest:
      type: object
      properties:
        email:
          type: string
        password:
          type: string
      required:
        - email
        - password

    AuthResponse:
      type: object
      properties:
        token:
          type: string
        user:
          $ref: '#/components/schemas/User'

    SocialAuthRequest:
      type: object
      properties:
        provider:
          type: string
          enum: [google, facebook, twitter]
        token:
          type: string
      required:
        - provider
        - token

    MagicLinkRequest:
      type: object
      properties:
        email:
          type: string
      required:
        - email

    ChangePasswordRequest:
      type: object
      properties:
        currentPassword:
          type: string
        newPassword:
          type: string
      required:
        - currentPassword
        - newPassword

    User:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
        name:
          type: string
        role:
          type: string
          enum: [user, admin, superadmin]
        createdAt:
          type: string
          format: date-time

    UpdateUserRequest:
        type: object
        properties:
          name:
            type: string
          email:
            type: string

    UsersList:
      type: object
      properties:
        users:
          type: array
          items:
            $ref: '#/components/schemas/User'
        totalCount:
          type: integer
        page:
          type: integer
        limit:
          type: integer

    CreateUserRequest:
      type: object
      properties:
        name:
          type: string
        email:
          type: string
        password:
          type: string
      required:
        - name
        - email
        - password

    Organization:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    OrganizationsList:
      type: object
      properties:
        organizations:
          type: array
          items:
            $ref: '#/components/schemas/Organization'
        totalCount:
          type: integer
        page:
          type: integer
        limit:
          type: integer

    CreateOrganizationRequest:
      type: object
      properties:
        name:
          type: string
      required:
        - name

    UpdateOrganizationRequest:
      type: object
      properties:
        name:
          type: string

    Payment:
      type: object
      properties:
        id:
          type: string
        amount:
          type: number
        currency:
          type: string
        status:
          type: string
          enum: [pending, completed, failed]
        provider:
          type: string
          enum: [stripe, flutterwave, lemonsqueezy]
        createdAt:
          type: string
          format: date-time

    CreatePaymentRequest:
      type: object
      properties:
        amount:
          type: number
        currency:
          type: string
        provider:
          type: string
          enum: [stripe, flutterwave, lemonsqueezy]
      required:
        - amount
        - currency
        - provider

    SendMessageRequest:
      type: object
      properties:
        recipient:
          type: string
        subject:
          type: string
        body:
          type: string
        templateId:
          type: string
      required:
        - recipient
        - subject
        - body

    UserSettings:
      type: object
      properties:
        language:
          type: string
        region:
          type: string
        notifications:
          type: object
          properties:
            email:
              type: boolean
            push:
              type: boolean

    UpdateSettingsRequest:
      type: object
      properties:
        language:
          type: string
        region:
          type: string
        notifications:
          type: object
          properties:
            email:
              type: boolean
            push:
              type: boolean

    ContactFormRequest:
      type: object
      properties:
        name:
          type: string
        email:
          type: string
        message:
          type: string
      required:
        - name
        - email
        - message

    WaitlistRequest:
      type: object
      properties:
        email:
          type: string
      required:
        - email

    UserDataExport:
      type: object
      properties:
        personalInfo:
          $ref: '#/components/schemas/User'
        settings:
          $ref: '#/components/schemas/UserSettings'
        widgets:
          type: array
          items:
            $ref: '#/components/schemas/Widget'

    Widget:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        type:
          type: string
        data:
          type: object
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    WidgetsList:
      type: object
      properties:
        widgets:
          type: array
          items:
            $ref: '#/components/schemas/Widget'
        totalCount:
          type: integer
        page:
          type: integer
        limit:
          type: integer

    CreateWidgetRequest:
      type: object
      properties:
        name:
          type: string
        type:
          type: string
        data:
          type: object
      required:
        - name
        - type

    DataList:
      type: object
      properties:
        items:
          type: array
          items:
            type: object
        totalCount:
          type: integer
        page:
          type: integer
        limit:
          type: integer

    ChartData:
      type: object
      properties:
        labels:
          type: array
          items:
            type: string
        datasets:
          type: array
          items:
            type: object
            properties:
              label:
                type: string
              data:
                type: array
                items:
                  type: number

    UpdateContentRequest:
      type: object
      properties:
        contentId:
          type: string
        content:
          type: string
      required:
        - contentId
        - content

    Notification:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
        message:
          type: string
        read:
          type: boolean
        createdAt:
          type: string
          format: date-time

    NotificationsList:
      type: object
      properties:
        notifications:
          type: array
          items:
            $ref: '#/components/schemas/Notification'
        totalCount:
          type: integer
        page:
          type: integer
        limit:
          type: integer

    BlogPost:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        content:
          type: string
        author:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    BlogPostsList:
      type: object
      properties:
        posts:
          type: array
          items:
            $ref: '#/components/schemas/BlogPost'
        totalCount:
          type: integer
        page:
          type: integer
        limit:
          type: integer

    CreateInviteRequest:
      type: object
      properties:
        email:
          type: string
        role:
          type: string
          enum: [user, admin]
      required:
        - email
        - role

    InviteLink:
      type: object
      properties:
        id:
          type: string
        email:
          type: string
        role:
          type: string
        token:
          type: string
        expiresAt:
          type: string
          format: date-time

    EmailTemplate:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        subject:
          type: string
        body:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    EmailTemplatesList:
      type: object
      properties:
        templates:
          type: array
          items:
            $ref: '#/components/schemas/EmailTemplate'
        totalCount:
          type: integer
        page:
          type: integer
        limit:
          type: integer

    CreateEmailTemplateRequest:
      type: object
      properties:
        name:
          type: string
        subject:
          type: string
        body:
          type: string
      required:
        - name
        - subject
        - body

    AIRequest:
      type: object
      properties:
        prompt:
          type: string
        options:
          type: object
      required:
        - prompt

    AIResponse:
      type: object
      properties:
        result:
          type: string

    ActivityLogEntry:
      type: object
      properties:
        id:
          type: string
        userId:
          type: string
        action:
          type: string
        details:
          type: object
        createdAt:
          type: string
          format: date-time

    ActivityLog:
      type: object
      properties:
        entries:
          type: array
          items:
            $ref: '#/components/schemas/ActivityLogEntry'
        totalCount:
          type: integer
        page:
          type: integer
        limit:
          type: integer
externalDocs:
  description: "Find out more about our API"
  url: "https://github.com/daviduzondu/team_beetle_hng_boilerplate_node_web/tree/main"
